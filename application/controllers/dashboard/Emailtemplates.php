<?php if (!defined('BASEPATH')) exit('No direct script access allowed');class Emailtemplates extends CI_Controller{	function __construct()	{				parent::__construct();				$session_data = $this->session->userdata('admin_user');		if($session_data['admin_user_type_id']==2){			redirect('admin/dashboard');		}				if(!$this->session->userdata('admin_user'))    	{    		redirect('admin/login', 'refresh');    	}    	$this->load->model('emailtemplates_model');		$this->load->model('user_model');		$this->load->model('news_event_model');		$this->load->model('register_model');		$this->load->library('email');		//$this->load->model('city_model');	}	function manage_email_templates()	{		    		$session_data = $this->session->userdata('admin_user');		    $data['username'] = $session_data['admin_username'];			$header['main_page'] = 'manage_email_templates';		    $header['tab'] = 'email_template';		    $header['username'] =  $data['username'];		    $sidebar['page'] = 'email_template';		    $sidebar['main_page'] = 'manage_email_templates';		    $sidebar['username'] =  $data['username'];		    		    $footer['main_page'] = 'manage_email_templates';		   $data['emailTemplateList'] = $this->emailtemplates_model->GetEmailTemplates();		   			$this->load->view('admin/parts/header',$header);			$this->load->view('admin/parts/sidebar_left',$sidebar);			$this->load->view('admin/email_template/email_template_list',$data);			$this->load->view('admin/parts/footer',$footer);    		}	function add_template()	{		$path = '../assets/admin/js/ckfinder';		$width = '500px';		$this->editor($path, $width);				$this->load->helper(array('form', 'url'));		$this->load->library('form_validation');					$session_data = $this->session->userdata('admin_user');		    $data['username'] = $session_data['admin_username'];		    $header['main_page'] = 'add_template';		    $header['tab'] = 'email_template';		    $header['username'] =  $data['username'];		    $sidebar['page'] = 'email_template';		    $sidebar['main_page'] = 'add_template';		    $sidebar['username'] =  $data['username'];		    		    $footer['main_page'] = 'add_template';	//by aglram	  		//end by aglram	  			//create error array		$error_arr = array();				// Displaying Errors In Div		//$this->form_validation->set_error_delimiters('<div class="error">', '</div>');				  		  		  if($_SERVER['REQUEST_METHOD']=='POST')		  {			  				$this->form_validation->set_rules('email_title', 'Email Title', 'strip_tags|trim|required|xss_clean');				$this->form_validation->set_rules('email_subject', 'Email Subject', 'strip_tags|trim|required|xss_clean');								if($this->input->post('message_type')=='textbox'){					$this->form_validation->set_rules('email_description', 'Email Description', 'trim|required|xss_clean');				}											  if ($this->form_validation->run() == FALSE){				  				$this->load->view('admin/parts/header',$header);		        $this->load->view('admin/parts/sidebar_left',$sidebar);		        $this->load->view('admin/email_template/add_email_template',$data);		        $this->load->view('admin/parts/footer',$footer);			} 			else {							if($this->input->post('message_type')=='templatefiles'){				// Email Template upload Start												$email_template_file = '';												if($_FILES['templateFile']['name'] != ""){														$new_template_name = strtolower(str_replace(" ","-",preg_replace('/[^A-Za-z0-9\-]/', '',$this->input->post('email_title'))))."_".time().'_'.strtolower(str_replace(" ","-",$_FILES["templateFile"]['name']));							$config['upload_path']   = './uploads/email_template'; 							$config['file_name'] = $new_template_name;							$config['allowed_types'] = '*'; 							/* $config['max_size']      = 100; 							$config['max_width']     = 100; 							$config['max_height']    = 100; */																					$this->load->library('upload', $config);							$this->upload->initialize($config);							if ( ! $this->upload->do_upload('templateFile')) {								$error = array('error' => $this->upload->display_errors());								$error_arr[] = $error['error']."(Template File)";							} else { 															$data_user = array('upload_data' => $this->upload->data());								$email_template_file = "/uploads/email_template/".$new_template_name;							}												}											// Email Template upload End			}											$data_addtemplate = array(				     	'email_title' => $this->input->post('email_title'),				     	'email_subject' => $this->input->post('email_subject'),				     	'desc_type' => $this->input->post('message_type'),				     	'status' => $this->input->post('status')						);						if($this->input->post('message_type')=='textbox'){				$data_addtemplate['email_description'] = $this->input->post('email_description');			}elseif($this->input->post('message_type')=='templatefiles'){				$data_addtemplate['email_temp_file'] = $email_template_file;			}								   			//date_default_timezone_set('UTC');				    $data_addtemplate['created'] = date('Y/m/d  h:m:s');				$this->emailtemplates_model->save_EmailTemplate($data_addtemplate);				 						//after successful submission				$this->session->set_flashdata('success', 'You have added email template successfully.');				//redirect('admin/event/add_event/');				redirect('admin/email_template/manage_email_templates/');									  }			  }			  else {							$this->load->view('admin/parts/header',$header);			$this->load->view('admin/parts/sidebar_left',$sidebar);			$this->load->view('admin/email_template/add_email_template',$data);			$this->load->view('admin/parts/footer',$footer);							  }			}	function edit_template($id = Null)	{		$path = '../assets/admin/js/ckfinder';		$width = '500px';		$this->editor($path, $width);					if($id == NULL)		{			//redirect('admin/event/manage_event');		}				$this->load->helper(array('form', 'url'));		$this->load->library('form_validation');		    	$session_data = $this->session->userdata('admin_user');		    $data['username'] = $session_data['admin_username'];		    $header['main_page'] = 'edit_template';		    $header['tab'] = 'email_template';		    $header['username'] =  $data['username'];		    $sidebar['page'] = 'email_template';		    $sidebar['main_page'] = 'edit_template';		    $sidebar['username'] =  $data['username'];		    		    $footer['main_page'] = 'edit_template';		  		$data['emailtemplatesdetails'] = $this->emailtemplates_model->GetEmailTemplateByID($id);					$error_arr = array();				// Displaying Errors In Div		$this->form_validation->set_error_delimiters('<div class="error">', '</div>');						  		  if($_SERVER['REQUEST_METHOD']=='POST')		  {										$this->form_validation->set_rules('email_title', 'Email Title', 'strip_tags|trim|required|xss_clean');				$this->form_validation->set_rules('email_subject', 'Email Subject', 'strip_tags|trim|required|xss_clean');								if($this->input->post('message_type')=='textbox'){					$this->form_validation->set_rules('email_description', 'Email Description', 'trim|required|xss_clean');				}									  			if ($this->form_validation->run() == FALSE){				  				$this->load->view('admin/parts/header',$header);		        $this->load->view('admin/parts/sidebar_left',$sidebar);		        $this->load->view('admin/email_template/edit_email_template',$data);		        $this->load->view('admin/parts/footer',$footer);			} 			else {								if($this->input->post('message_type')=='templatefiles'){				// Email Template upload Start												$email_template_file = '';												if($_FILES['templateFile']['name'] != ""){														$new_template_name = strtolower(str_replace(" ","-",preg_replace('/[^A-Za-z0-9\-]/', '',$this->input->post('email_title'))))."_".time().'_'.strtolower(str_replace(" ","-",$_FILES["templateFile"]['name']));							$config['upload_path']   = './uploads/email_template'; 							$config['file_name'] = $new_template_name;							$config['allowed_types'] = '*'; 							/* $config['max_size']      = 100; 							$config['max_width']     = 100; 							$config['max_height']    = 100; */																					$this->load->library('upload', $config);							$this->upload->initialize($config);							if ( ! $this->upload->do_upload('templateFile')) {								$error = array('error' => $this->upload->display_errors());								$error_arr[] = $error['error']."(Template File)";							} else { 															$data_user = array('upload_data' => $this->upload->data());								$email_template_file = "/uploads/email_template/".$new_template_name;							}												}else{							$email_template_file  = $this->input->post('exist_templatefile');						}											// Email Template upload End			}				$data_updatetemplate = array(				     	'email_title' => $this->input->post('email_title'),				     	'email_subject' => $this->input->post('email_subject'),				     	'desc_type' => $this->input->post('message_type'),				     	'status' => $this->input->post('status')						);						if($this->input->post('message_type')=='textbox'){								$data_updatetemplate['email_description'] = $this->input->post('email_description');			}elseif($this->input->post('message_type')=='templatefiles'){				$Tempfile = base_url().$email_template_file;	     		$emailDesc = file_get_contents($Tempfile);				$data_updatetemplate['email_description'] = $emailDesc;				$data_updatetemplate['email_temp_file'] = $email_template_file;			}								   			//date_default_timezone_set('UTC');				    $data_updatetemplate['created'] = date('Y/m/d  h:m:s');				$this->emailtemplates_model->update_EmailTemplate($id,$data_updatetemplate);				 					//after successful submission			$this->session->set_flashdata('success', 'You have updated email template successfully.');			//redirect('admin/event/add_event/');			redirect('admin/email_template/manage_email_templates/');											  }	}			  else {													$this->load->view('admin/parts/header',$header);			$this->load->view('admin/parts/sidebar_left',$sidebar);			$this->load->view('admin/email_template/edit_email_template',$data);			$this->load->view('admin/parts/footer',$footer);							  }			}		function delete_template($id=null)	{				if($id!=null){						$delete = $this->emailtemplates_model->delete_EmailTemplate($id);						if($delete==true){				//after successful submission				$this->session->set_flashdata('success', 'You have Deleted template successfully.');				redirect('admin/email_template/manage_email_templates');			}		}			}		function active_template($id=null)	{				if($id!=null){			$status = array('status'=> 'Active');			$delete = $this->emailtemplates_model->delete_course_by_id($id,$status);			if($delete==true){				//after successful submission				$this->session->set_flashdata('success', 'You have active course successfully.');				redirect('admin/course/manage_course');			}		}			}	 	function alpha_dash_space($str) {				if( ! preg_match("/^([-a-z_ \"#$%&'()*+,\-.\\:\/;=?@^_])+$/i", $str)){ 					$this->form_validation->set_message('alpha_dash_space', 'The Title Field Should Be Valid');						return FALSE;		}else{ 						return TRUE; 		} 	}			function send_bulk_email(){				$this->load->helper(array('form', 'url'));		$this->load->library('form_validation');				$data['email_template'] = $this->emailtemplates_model->GetEmailTemplates();		$data['exhibition_city'] = $this->news_event_model->getExhibitionAllCity();		//$data['online_registered_user'] = $this->register_model->GetEmailTemplates();				//echo '<pre>'; print_r($data['exhibition_city']); die;					$session_data = $this->session->userdata('admin_user');		    $data['username'] = $session_data['admin_username'];		    $header['main_page'] = 'send_bulk_email';		    $header['tab'] = 'bulk_email';		    $header['username'] =  $data['username'];		    $sidebar['page'] = 'send_bulk_email';		    $sidebar['main_page'] = 'send_bulk_email';		    $sidebar['username'] =  $data['username'];		    		    $footer['main_page'] = 'send_bulk_email';					 if($_SERVER['REQUEST_METHOD']=='POST')		 {			 			 $this->form_validation->set_rules('email_template', 'Email Template', 'required');								if($this->input->post('type')=='register user'){					$this->form_validation->set_rules('city', 'City', 'required');				}											if ($this->form_validation->run() == FALSE){								$this->load->view('admin/parts/header',$header);				$this->load->view('admin/parts/sidebar_left',$sidebar);				$this->load->view('admin/bulk_email/send_bulk_email',$data);				$this->load->view('admin/parts/footer',$footer);							}else{			 if($this->input->post('type') == "upload file"){				 				// echo "Test new"; die;				 $csvrecipients = '';				 					 if($_FILES['emailFile']['name']){							$arrFileName = explode('.',$_FILES['emailFile']['name']);						if($arrFileName[1] == 'csv'){							$handle = fopen($_FILES['emailFile']['tmp_name'], "r");												$i = 0;									 						 while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {										//print_r($data);						$num = count($data); 								if($i==0) { $i++; continue; }  // to exclude first row in the csv file.									 						// $recipients = '';						 for ($c=0; $c < $num; $c++) 						 {							  $col[$c] = $data[$c];							  $csvrecipients.= $col[$c].","; 								// $temp = false;						  }						} 						fclose($handle);											} 				}				//echo $csvrecipients; die;				$templateId = $this->input->post('email_template');				//echo $templateId; die;				$templateData = $this->emailtemplates_model->GetEmailTemplateByID($templateId);											$toU = $csvrecipients;				$fromU = $this->config->item('FromEmail');				$subjectU = $templateData->email_subject;				$messageU = $templateData->email_description;				$sendMailUser = $this->sendEmail($toU,$fromU,$subjectU,$messageU);								$this->session->set_flashdata('success', 'Email Sent successfully!.');				redirect('admin/email_template/send_bulk_email');										 }elseif($this->input->post('type') == "register user"){								$cityId = $this->input->post('city');								$online_user_data = $this->register_model->get_online_register_user_by_city($cityId);				$city_user_data = $this->register_model->get_city_register_user_by_city($cityId);				//$exhibitior_user_data = $this->register_model->get_exhibitor_register_user_by_city($cityId);								$usersArr = array();				$users = '';								if(sizeof($online_user_data) > 0){										foreach($online_user_data as $online_user){						$usersArr[] = $online_user->email;					}				}								 if(sizeof($city_user_data) > 0){										foreach($city_user_data as $city_user){						$usersArr[] = $city_user->email;					}				}								/*if(sizeof($exhibitior_user_data) > 0){										foreach($exhibitior_user_data as $exhibitior_user){						$usersArr[] = $exhibitior_user->email;					}				} */			//	echo '<pre>'; print_r($usersArr); die;				if(sizeof($usersArr) > 0){					$usersArr = array_unique($usersArr);					$users = implode(',', $usersArr);					$userJson = json_encode($usersArr);				}								if($users !=""){									$email_history = array(						'email_template_id' => $this->input->post('email_template'),						'recipients' => $userJson,						'created' => date('Y-m-d H:i:s'),											);									$insert_id = $this->emailtemplates_model->add_bulk_data($email_history);																				$templateId = $this->input->post('email_template');					$templateData = $this->emailtemplates_model->GetEmailTemplateByID($templateId);					$toU = $users;					$fromU = $this->config->item('FromEmail');					$subjectU = $templateData->email_subject;					$messageU = $templateData->email_description;					//echo $messageU; die;					$sendMailUser = $this->sendEmail($toU,$fromU,$subjectU,$messageU);										$this->session->set_flashdata('success', 'Email Sent successfully!.');					redirect('admin/email_template/send_bulk_email');				}else{										$this->session->set_flashdata('error', 'No any recepients found!');					redirect('admin/email_template/send_bulk_email');				}								//echo '<pre>'; print_r($usersArr); die;			 }elseif($this->input->post('type') == "exhibitor"){								$cityId = $this->input->post('city');								//$online_user_data = $this->register_model->get_online_register_user_by_city($cityId);				//$city_user_data = $this->register_model->get_city_register_user_by_city($cityId);				$exhibitior_user_data = $this->register_model->get_exhibitor_register_user_by_city($cityId);								$usersArr = array();				$users = '';								/* if(sizeof($online_user_data) > 0){										foreach($online_user_data as $online_user){						$usersArr[] = $online_user->email;					}				}								if(sizeof($city_user_data) > 0){										foreach($city_user_data as $city_user){						$usersArr[] = $city_user->email;					}				} */								if(sizeof($exhibitior_user_data) > 0){										foreach($exhibitior_user_data as $exhibitior_user){						$usersArr[] = $exhibitior_user->email;					}				}			//	echo '<pre>'; print_r($usersArr); die;				if(sizeof($usersArr) > 0){					$usersArr = array_unique($usersArr);					$users = implode(',', $usersArr);					$userJson = json_encode($usersArr);				}								if($users !=""){								$email_history = array(						'email_template_id' => $this->input->post('email_template'),						'recipients' => $userJson,						'created' => date('Y-m-d H:i:s'),											);									$insert_id = $this->emailtemplates_model->add_bulk_data($email_history);																				$templateId = $this->input->post('email_template');					$templateData = $this->emailtemplates_model->GetEmailTemplateByID($templateId);					$toU = $users;					$fromU = $this->config->item('FromEmail');					$subjectU = $templateData->email_subject;					$messageU = $templateData->email_description;					//echo $messageU; die;					$sendMailUser = $this->sendEmail($toU,$fromU,$subjectU,$messageU);										$this->session->set_flashdata('success', 'Email Sent successfully!.');					redirect('admin/email_template/send_bulk_email');				}else{										$this->session->set_flashdata('error', 'No any recepients found!');					redirect('admin/email_template/send_bulk_email');				}								//echo '<pre>'; print_r($usersArr); die;			 }elseif($this->input->post('type') == "register exhibitor users"){								$cityId = $this->input->post('city');								$online_user_data = $this->register_model->get_online_register_user_by_city($cityId);				$city_user_data = $this->register_model->get_city_register_user_by_city($cityId);				$exhibitior_user_data = $this->register_model->get_exhibitor_register_user_by_city($cityId);								$usersArr = array();				$users = '';								if(sizeof($online_user_data) > 0){										foreach($online_user_data as $online_user){						$usersArr[] = $online_user->email;					}				}								if(sizeof($city_user_data) > 0){										foreach($city_user_data as $city_user){						$usersArr[] = $city_user->email;					}				}								if(sizeof($exhibitior_user_data) > 0){										foreach($exhibitior_user_data as $exhibitior_user){						$usersArr[] = $exhibitior_user->email;					}				}			//	echo '<pre>'; print_r($usersArr); die;				if(sizeof($usersArr) > 0){					$usersArr = array_unique($usersArr);					$users = implode(',', $usersArr);					$userJson = json_encode($usersArr);				}								if($users !=""){								$email_history = array(						'email_template_id' => $this->input->post('email_template'),						'recipients' => $userJson,						'created' => date('Y-m-d H:i:s'),											);									$insert_id = $this->emailtemplates_model->add_bulk_data($email_history);																				$templateId = $this->input->post('email_template');					$templateData = $this->emailtemplates_model->GetEmailTemplateByID($templateId);					$toU = $users;					$fromU = $this->config->item('FromEmail');					$subjectU = $templateData->email_subject;					$messageU = $templateData->email_description;					//echo $messageU; die;					$sendMailUser = $this->sendEmail($toU,$fromU,$subjectU,$messageU);										$this->session->set_flashdata('success', 'Email Sent successfully!.');					redirect('admin/email_template/send_bulk_email');				}else{										$this->session->set_flashdata('error', 'No any recepients found!');					redirect('admin/email_template/send_bulk_email');				}								//echo '<pre>'; print_r($usersArr); die;			 }						}		 		/* =========================================================== */			 		 }else{			 			$this->load->view('admin/parts/header',$header);			$this->load->view('admin/parts/sidebar_left',$sidebar);			$this->load->view('admin/bulk_email/send_bulk_email',$data);			$this->load->view('admin/parts/footer',$footer);			 }			  							}		function send_bulk_sms(){		$this->load->helper(array('form', 'url'));		$this->load->library('form_validation');				$data['exhibition_city'] = $this->news_event_model->getExhibitionAllCity();		//$data['online_registered_user'] = $this->register_model->GetEmailTemplates();				//echo '<pre>'; print_r($data['exhibition_city']); die;					$session_data = $this->session->userdata('admin_user');		    $data['username'] = $session_data['admin_username'];		    $header['main_page'] = 'send_bulk_sms';		    $header['tab'] = 'bulk_sms';		    $header['username'] =  $data['username'];		    $sidebar['page'] = 'send_bulk_sms';		    $sidebar['main_page'] = 'send_bulk_sms';		    $sidebar['username'] =  $data['username'];		    		    $footer['main_page'] = 'send_bulk_sms';						 if($_SERVER['REQUEST_METHOD']=='POST')			 {				$this->form_validation->set_rules('sms', 'SMS', 'required');								if($this->input->post('type')=='register user'){					$this->form_validation->set_rules('city', 'City', 'required');				}								if ($this->form_validation->run() == FALSE){									$this->load->view('admin/parts/header',$header);					$this->load->view('admin/parts/sidebar_left',$sidebar);					$this->load->view('admin/bulk_email/send_bulk_sms',$data);					$this->load->view('admin/parts/footer',$footer);							}else{										if($this->input->post('type') == "upload file"){				 				// echo "Test new"; die;				 $csvrecipients = '';				 					 if($_FILES['emailFile']['name']){							$arrFileName = explode('.',$_FILES['emailFile']['name']);						if($arrFileName[1] == 'csv'){							$handle = fopen($_FILES['emailFile']['tmp_name'], "r");												$i = 0;									 						 while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {										//print_r($data);						$num = count($data); 								if($i==0) { $i++; continue; }  // to exclude first row in the csv file.									 						// $recipients = '';						 for ($c=0; $c < $num; $c++) 						 {							  $col[$c] = $data[$c];							  $csvrecipients.= $col[$c].","; 							  							  $text = $this->input->post('sms');																														$mob_no = trim($csvrecipients);																$url = "http://www.myvaluefirst.com/smpp/sendsms&username=$username&password=$password&to=$mob_no&from=$sender_id&text=$text&dlr-url=&category=bulk";								//echo "http://www.myvaluefirst.com/smpp/sendsms&username=$username&password=$password&to=$mob_no&from=$sender_id&text=$text&dlr-url=&category=bulk"; die;																$ch = curl_init();                  								curl_setopt($ch, CURLOPT_URL,$url);								curl_setopt($ch, CURLOPT_POST, true); 								curl_setopt($ch, CURLOPT_POSTFIELDS, "username=$username&password=$password&to=$mob_no&from=$sender_id&text=$text&dlr-url=&category=bulk"); // define what you want to post								curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 								$output123 = curl_exec ($ch);								curl_close ($ch);								// $temp = false;						  }						} 						fclose($handle);											} 				}																$this->session->set_flashdata('success', 'SMS Sent successfully!.');				redirect('admin/email_template/send_bulk_email');										 }elseif($this->input->post('type') == "register user"){								$cityId = $this->input->post('city');								$online_user_data = $this->register_model->get_online_register_user_by_city($cityId);				$city_user_data = $this->register_model->get_city_register_user_by_city($cityId);				$exhibitior_user_data = $this->register_model->get_exhibitor_register_user_by_city($cityId);								$usersArr = array();				$users = '';								if(sizeof($online_user_data) > 0){										foreach($online_user_data as $online_user){						$usersArr[] = $online_user->mobile;					}				}								if(sizeof($city_user_data) > 0){										foreach($city_user_data as $city_user){						$usersArr[] = $city_user->mobile;					}				}								if(sizeof($exhibitior_user_data) > 0){										foreach($exhibitior_user_data as $exhibitior_user){						$usersArr[] = $exhibitior_user->contact;					}				}			//	echo '<pre>'; print_r($usersArr); die;				if(sizeof($usersArr) > 0){					$usersArr = array_unique($usersArr);					$users = implode(',', $usersArr);					$userJson = json_encode($usersArr);				}								$sms_history = array(						'message' => $this->input->post('sms'),						'recipients' => $userJson,						'created' => date('Y-m-d H:i:s'),											);									$insert_id = $this->emailtemplates_model->add_bulk_sms_data($sms_history);										if($users !=""){										/* $username = $smsDetail['8']->option_value;					$password = $smsDetail['9']->option_value; */					$mobile = "";					foreach($usersArr as $userData){						$text = $this->input->post('sms');												if(isset($userData->mobile)){							$mobile = $userData->mobile;						}elseif($userData->contact){							$mobile = $userData->contact;						}												$mob_no = trim($mobile);												$url = "http://www.myvaluefirst.com/smpp/sendsms&username=$username&password=$password&to=$mob_no&from=$sender_id&text=$text&dlr-url=&category=bulk";						//echo "http://www.myvaluefirst.com/smpp/sendsms&username=$username&password=$password&to=$mob_no&from=$sender_id&text=$text&dlr-url=&category=bulk"; die;												$ch = curl_init();                  						curl_setopt($ch, CURLOPT_URL,$url);						curl_setopt($ch, CURLOPT_POST, true); 						curl_setopt($ch, CURLOPT_POSTFIELDS, "username=$username&password=$password&to=$mob_no&from=$sender_id&text=$text&dlr-url=&category=bulk"); // define what you want to post						curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 						$output123 = curl_exec ($ch);						curl_close ($ch);					}									}else{										$this->session->set_flashdata('error', 'No any recepients found!');					redirect('admin/email_template/send_bulk_sms');				}								//echo '<pre>'; print_r($usersArr); die;			 }			}											 }else{				 					$this->load->view('admin/parts/header',$header);					$this->load->view('admin/parts/sidebar_left',$sidebar);					$this->load->view('admin/bulk_email/send_bulk_sms',$data);					$this->load->view('admin/parts/footer',$footer);			 }	}		function sendEmail($to,$from,$subject,$message){		$config['mailtype'] = 'html';		$this->email->initialize($config);		$this->email->to($to);		$this->email->from($from,$this->config->item('Site_name'));		$this->email->subject($subject);		$this->email->message($message);						if($this->email->send()){			return true;		}else{			return false;					}	}		public function viewtemplate($id)	{		$session_data = $this->session->userdata('admin_user');		    $data['username'] = $session_data['admin_username'];		    $header['main_page'] = 'send_bulk_email';		    $header['tab'] = 'bulk_email';		    $header['username'] =  $data['username'];		    $sidebar['page'] = 'send_bulk_email';		    $sidebar['main_page'] = 'send_bulk_email';		    $sidebar['username'] =  $data['username'];		    		    $footer['main_page'] = 'send_bulk_email';						 	$output['template_details'] = $this->emailtemplates_model->GetEmailTemplateByID($id);	 	//$output['title'] = 'Template View';			$this->load->view('admin/parts/header',$header);			$this->load->view('admin/parts/sidebar_left',$sidebar);			$this->load->view('admin/email_template/email_template_view',$output);			$this->load->view('admin/parts/footer',$footer);				 		//$this->load->view('email_template/email_template_view',$output); 	}				 function editor($path,$width) {    //Loading Library For Ckeditor    $this->load->library('ckeditor');    $this->load->library('ckFinder');    //configure base path of ckeditor folder     $this->ckeditor->basePath = base_url().'/assets/admin/js/ckeditor/';    $this->ckeditor-> config['toolbar'] = 'Full';		$this->ckeditor-> config['allowedContent'] = 'true';	$this->ckeditor-> config['removeFormatAttributes'] = '';     $this->ckeditor->config['language'] = 'en';    $this->ckeditor-> config['width'] = $width;    //configure ckfinder with ckeditor config     $this->ckfinder->SetupCKEditor($this->ckeditor,$path);   }	//end by aglram}?>